{
  "_type": "export",
  "__export_format": 4,
  "__export_date": "2025-01-09T00:00:00.000Z",
  "__export_source": "insomnia.desktop.app:v2023.5.8",
  "resources": [
    {
      "_id": "req_chats_create",
      "parentId": "fld_basic_ops",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats",
      "name": "1. Create Chat",
      "description": "Create a new chat session â†’ saves chat_id\nReturns 201 on success, 409 if duplicate title exists",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"project_id\": \"{{ _.project_id }}\",\n  \"title\": \"Test Chat - Character Analysis\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698796800000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.id) {\n  await insomnia.environment.set('chat_id', response.id);\n  console.log('âœ… Saved chat_id:', response.id);\n  console.log('Title:', response.title);\n}"
    },
    {
      "_id": "req_chats_list",
      "parentId": "fld_basic_ops",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats?project_id={{ _.project_id }}",
      "name": "2. List Chats",
      "description": "Get all chats for a project (ordered by updated_at DESC)\nReturns empty array [] if no chats found",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698796700000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.length > 0) {\n  await insomnia.environment.set('chat_id', response[0].id);\n  console.log('âœ… Saved first chat_id:', response[0].id);\n  console.log('Total chats:', response.length);\n} else {\n  console.log('â„¹ï¸  No chats found for this project');\n}"
    },
    {
      "_id": "req_chats_get",
      "parentId": "fld_basic_ops",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}",
      "name": "3. Get Chat by ID",
      "description": "Retrieve a specific chat â†’ refreshes chat_id\nReturns 404 if chat not found or deleted",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698796600000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.id) {\n  await insomnia.environment.set('chat_id', response.id);\n  console.log('âœ… Refreshed chat_id:', response.id);\n  console.log('Title:', response.title);\n  console.log('Created:', response.created_at);\n}"
    },
    {
      "_id": "req_chats_update",
      "parentId": "fld_basic_ops",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}",
      "name": "4. Update Chat Title",
      "description": "Rename a chat (updates updated_at automatically)\nReturns 409 if new title conflicts with existing chat",
      "method": "PATCH",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"title\": \"Updated Chat Title - Story Deep Dive\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698796500000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.id) {\n  console.log('âœ… Updated chat:', response.id);\n  console.log('New title:', response.title);\n  console.log('Updated at:', response.updated_at);\n}"
    },
    {
      "_id": "req_chats_delete",
      "parentId": "fld_basic_ops",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}",
      "name": "5. Delete Chat (Soft)",
      "description": "Soft-delete a chat (sets deleted_at timestamp)\nReturns the deleted chat with deleted_at populated\nDeleted chats won't appear in list/get queries",
      "method": "DELETE",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698796400000,
      "isPrivate": false,
      "_type": "request"
    },
    {
      "_id": "req_turns_create_root",
      "parentId": "fld_turns",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}/turns",
      "name": "1. Create Root Turn (User)",
      "description": "Create first turn in conversation (prev_turn_id = null)\nRole: 'user', with text content block\nReturns 201 with turn_id â†’ saves to environment",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"role\": \"user\",\n  \"turn_blocks\": [\n    {\n      \"block_type\": \"text\",\n      \"text_content\": \"Analyze the protagonist's character arc in Chapter 1\"\n    }\n  ],\n  \"request_params\": {\n    \"model\": \"lorem-fast\",\n    \"max_tokens\": 100\n  }\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698796300000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.user_turn) {\n  await insomnia.environment.set('turn_id', response.user_turn.id);\n  await insomnia.environment.set('root_turn_id', response.user_turn.id);\n  await insomnia.environment.set('assistant_turn_id', response.assistant_turn?.id);\n  console.log('âœ… Created root turn:', response.user_turn.id.substring(0, 8) + '...');\n  console.log('Role:', response.user_turn.role, '| Status:', response.user_turn.status);\n  console.log('Turn blocks:', response.user_turn.turn_blocks?.length || 0);\n  if (response.assistant_turn) {\n    console.log('âœ… Assistant turn:', response.assistant_turn.id.substring(0, 8) + '... (streaming)');\n  }\n}"
    },
    {
      "_id": "req_turns_create_child",
      "parentId": "fld_turns",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/debug/api/chats/{{ _.chat_id }}/turns",
      "name": "2. Create Child Turn (Assistant) [DEBUG ONLY]",
      "description": "Create an assistant turn using the debug-only endpoint\nRole: 'assistant' for AI response\n\nDEBUG ENDPOINT: POST /debug/api/chats/:id/turns\nOnly available when ENVIRONMENT=dev\n\nPhase 1 (Current): This debug endpoint allows manual assistant turn creation for testing.\nPhase 2 (Streaming): Use streaming requests instead - user turns trigger automatic assistant streaming.\n\nProduction: This endpoint does NOT exist (returns 404)",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"prev_turn_id\": \"{{ _.turn_id }}\",\n  \"role\": \"assistant\",\n  \"turn_blocks\": [\n    {\n      \"block_type\": \"text\",\n      \"text_content\": \"The protagonist demonstrates significant growth through...\"\n    }\n  ]\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698796200000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.id) {\n  await insomnia.environment.set('turn_id', response.id);\n  await insomnia.environment.set('assistant_turn_id', response.id);\n  console.log('âœ… Created child turn:', response.id);\n  console.log('Parent:', response.prev_turn_id);\n  console.log('Role:', response.role);\n}"
    },
    {
      "_id": "req_turns_create_branch",
      "parentId": "fld_turns",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}/turns",
      "name": "3. Create Branch Turn",
      "description": "Branch conversation from assistant_turn_id\nCreates alternative path in conversation tree\nMultiple siblings = multiple versions/branches",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"prev_turn_id\": \"{{ _.assistant_turn_id }}\",\n  \"role\": \"user\",\n  \"turn_blocks\": [\n    {\n      \"block_type\": \"text\",\n      \"text_content\": \"How does this compare to the antagonist's development?\"\n    }\n  ]\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698796100000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.user_turn) {\n  await insomnia.environment.set('branch_turn_id', response.user_turn.id);\n  console.log('âœ… Created branch turn:', response.user_turn.id.substring(0, 8) + '...');\n  console.log('Branches from:', response.user_turn.prev_turn_id);\n  console.log('ðŸ’¡ Use GET /turns/:id/siblings to see all versions');\n}"
    },
    {
      "_id": "req_turns_get_path",
      "parentId": "fld_turns",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/turns/{{ _.turn_id }}/path",
      "name": "4. Get Turn Path (Root to Turn)",
      "description": "Get full conversation path from root to specified turn\nReturns turns in order: [root, child, grandchild, ...]\nUsed to build LLM context in Backend 4",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698796000000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && Array.isArray(response)) {\n  console.log('âœ… Found conversation path with', response.length, 'turn(s)');\n  response.forEach((turn, i) => {\n    console.log(`  ${i + 1}. [${turn.role}] ${turn.id.substring(0, 8)}...`);\n  });\n  console.log('ðŸ’¡ This path represents the full conversation context');\n}"
    },
    {
      "_id": "req_turns_get_siblings",
      "parentId": "fld_turns",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/turns/{{ _.assistant_turn_id }}/siblings",
      "name": "5. Get Turn Siblings (Versions)",
      "description": "Get all sibling turns (including self) for version browsing\nReturns array of turns with blocks (alternative versions sharing same parent)\nUsed for \"1 of 3\" version navigation UI",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698795900000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && Array.isArray(response)) {\n  console.log('âœ… Found', response.length, 'version(s) (including self)');\n  response.forEach((turn, i) => {\n    console.log(`  Version ${i + 1}: [${turn.role}] ${turn.id.substring(0, 8)}... (${turn.blocks?.length || 0} blocks)`);\n  });\n  if (response.length === 1) {\n    console.log('â„¹ï¸  No alternative versions (only this turn)');\n  }\n}"
    },
    {
      "_id": "req_content_text",
      "parentId": "fld_turn_blocks",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}/turns",
      "name": "1. Turn with Text Content",
      "description": "User turn with simple text content block\nMost common content type",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"role\": \"user\",\n  \"turn_blocks\": [\n    {\n      \"block_type\": \"text\",\n      \"text_content\": \"What are the major themes in this chapter?\"\n    }\n  ]\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698795800000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.user_turn) {\n  console.log('âœ… Created turn with text content');\n  console.log('Turn blocks:', response.user_turn.turn_blocks?.length);\n  if (response.user_turn.turn_blocks?.[0]) {\n    console.log('Block type:', response.user_turn.turn_blocks[0].block_type);\n  }\n}"
    },
    {
      "_id": "req_content_reference",
      "parentId": "fld_turn_blocks",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}/turns",
      "name": "2. Turn with Document Reference",
      "description": "User turn referencing entire document\nIncludes ref_id (document UUID) and ref_type",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"role\": \"user\",\n  \"turn_blocks\": [\n    {\n      \"block_type\": \"text\",\n      \"text_content\": \"Analyze this document:\"\n    },\n    {\n      \"block_type\": \"reference\",\n      \"content\": {\n        \"ref_id\": \"{{ _.document_id }}\",\n        \"ref_type\": \"document\"\n      }\n    }\n  ]\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698795700000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.user_turn) {\n  console.log('âœ… Created turn with document reference');\n  console.log('Turn blocks:', response.user_turn.turn_blocks?.length);\n  const refBlock = response.user_turn.turn_blocks?.find(b => b.block_type === 'reference');\n  if (refBlock) {\n    console.log('Referenced document:', refBlock.content?.ref_id);\n  }\n}"
    },
    {
      "_id": "req_content_partial",
      "parentId": "fld_turn_blocks",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}/turns",
      "name": "3. Turn with Partial Reference",
      "description": "User turn with text selection from document\nIncludes selection_start/end and copied text_content",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"role\": \"user\",\n  \"turn_blocks\": [\n    {\n      \"block_type\": \"partial_reference\",\n      \"text_content\": \"The protagonist's journey begins with a fateful decision...\",\n      \"content\": {\n        \"ref_id\": \"{{ _.document_id }}\",\n        \"ref_type\": \"document\",\n        \"selection_start\": 150,\n        \"selection_end\": 320\n      }\n    },\n    {\n      \"block_type\": \"text\",\n      \"text_content\": \"What does this passage reveal about their motivations?\"\n    }\n  ]\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698795600000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.user_turn) {\n  console.log('âœ… Created turn with partial reference');\n  const partialBlock = response.user_turn.turn_blocks?.find(b => b.block_type === 'partial_reference');\n  if (partialBlock) {\n    console.log('Selection:', partialBlock.content?.selection_start, '-', partialBlock.content?.selection_end);\n    console.log('Excerpt length:', partialBlock.text_content?.length, 'chars');\n  }\n}"
    },
    {
      "_id": "req_content_multiple",
      "parentId": "fld_turn_blocks",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}/turns",
      "name": "4. Turn with Multiple Blocks",
      "description": "Complex turn with mixed content types\nBlocks are stored in sequence order",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"role\": \"user\",\n  \"turn_blocks\": [\n    {\n      \"block_type\": \"text\",\n      \"text_content\": \"Compare these two chapters:\"\n    },\n    {\n      \"block_type\": \"reference\",\n      \"content\": {\n        \"ref_id\": \"{{ _.document_id }}\",\n        \"ref_type\": \"document\"\n      }\n    },\n    {\n      \"block_type\": \"reference\",\n      \"content\": {\n        \"ref_id\": \"{{ _.root_document_id }}\",\n        \"ref_type\": \"document\"\n      }\n    },\n    {\n      \"block_type\": \"text\",\n      \"text_content\": \"Focus on character development and pacing.\"\n    }\n  ]\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698795500000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.user_turn) {\n  console.log('âœ… Created turn with multiple content blocks');\n  console.log('Total blocks:', response.user_turn.turn_blocks?.length);\n  response.user_turn.turn_blocks?.forEach((block, i) => {\n    console.log(`  Block ${i + 1}: ${block.block_type}`);\n  });\n}"
    },
    {
      "_id": "req_streaming_create_turn",
      "parentId": "fld_streaming",
      "modified": 1736467200000,
      "created": 1736467200000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}/turns",
      "name": "1. Create User Turn (Triggers Streaming)",
      "description": "Create user turn â†’ automatically triggers assistant streaming\n\nNEW BEHAVIOR (Streaming):\n- Creates user turn (status='complete')\n- Creates assistant turn (status='streaming')\n- Returns BOTH turns in response\n- Client can immediately connect to stream_url\n\nRESPONSE:\n{\n  \"user_turn\": { \"id\": \"...\", \"status\": \"complete\" },\n  \"assistant_turn\": { \"id\": \"...\", \"status\": \"streaming\" },\n  \"stream_url\": \"/api/turns/:id/stream\"\n}",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"prev_turn_id\": \"{{ _.assistant_turn_id }}\",\n  \"role\": \"user\",\n  \"turn_blocks\": [\n    {\n      \"block_type\": \"text\",\n      \"text_content\": \"Can you search for a public domain short poem and write it to a file called poem.txt?\"\n    }\n  ],\n  \"request_params\": {\n    \"model\": \"{{ _.llm_model_streaming }}\",\n    \"max_tokens\": {{ _.llm_max_tokens_streaming }},\n    \"lorem_max\": 150,\n    \"thinking_enabled\": true,\n    \"thinking_level\": \"low\",\n    \"tools\": [\n      {\n        \"name\": \"web_search\"\n      },\n      {\n        \"type\": \"function\",\n        \"function\": {\n          \"name\": \"make_file\",\n          \"description\": \"Write text to a file\",\n          \"parameters\": {\n            \"type\": \"object\",\n            \"properties\": {\n              \"filename\": {\n                \"type\": \"string\",\n                \"description\": \"The filename to write text to\"\n              },\n              \"lines_of_text\": {\n                \"type\": \"array\",\n                \"description\": \"An array of lines of text to write to the file\",\n                \"items\": { \"type\": \"string\" }\n              }\n            },\n            \"required\": [\"filename\", \"lines_of_text\"]\n          }\n        }\n      }\n    ]\n  }\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json",
          "Accept": "text/event-stream"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698794250000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.user_turn && response.assistant_turn) {\n  await insomnia.environment.set('user_turn_id', response.user_turn.id);\n  await insomnia.environment.set('assistant_turn_id', response.assistant_turn.id);\n  await insomnia.environment.set('turn_id', response.user_turn.id);\n  console.log('âœ… User turn created:', response.user_turn.id.substring(0, 8) + '...');\n  console.log('   Role:', response.user_turn.role, '| Status:', response.user_turn.status);\n  console.log('');\n  console.log('âœ… Assistant turn created:', response.assistant_turn.id.substring(0, 8) + '...');\n  console.log('   Role:', response.assistant_turn.role, '| Status:', response.assistant_turn.status);\n  console.log('');\n  console.log('ðŸ’¡ Stream URL:', response.stream_url);\n  console.log('   Connect to SSE stream to see real-time deltas');\n}"
    },
    {
      "_id": "req_streaming_sse",
      "parentId": "fld_streaming",
      "modified": 1736467200000,
      "created": 1736467200000,
      "url": "{{ _.base_url }}/api/turns/{{ _.assistant_turn_id }}/stream",
      "name": "2. Stream Turn (SSE)",
      "description": "Connect to Server-Sent Events stream for real-time turn deltas\n\nEVENT FLOW:\n1. turn_start - Streaming begins\n2. block_start - New content block\n3. block_delta - Incremental text updates (many)\n4. block_stop - Block completed\n5. turn_complete - Turn finished\n\nRECONNECTION:\n- If disconnected, reconnect to same URL\n- Will receive block_catchup events for completed blocks\n- Then continues with live deltas\n\nInsomnia will display events in real-time.\nKeep this request open to continue receiving events.",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [{
        "name": "Accept",
        "value": "text/event-stream"
      }],
      "authentication": {},
      "metaSortKey": -1698794240000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "console.log('ðŸ“¡ SSE stream connected');\nconsole.log('â„¹ï¸  Events will appear in real-time');\nconsole.log('â¸ï¸  Keep this request open to continue receiving events');\nconsole.log('');\nconsole.log('Expected events:');\nconsole.log('  â€¢ turn_start');\nconsole.log('  â€¢ block_start');\nconsole.log('  â€¢ block_delta (many)');\nconsole.log('  â€¢ block_stop');\nconsole.log('  â€¢ turn_complete');"
    },
    {
      "_id": "req_streaming_get_blocks",
      "parentId": "fld_streaming",
      "modified": 1736467200000,
      "created": 1736467200000,
      "url": "{{ _.base_url }}/api/turns/{{ _.assistant_turn_id }}/blocks",
      "name": "3. Get Turn Blocks (Reconnection)",
      "description": "Fetch all completed turn blocks\n\nUSE CASES:\n1. Reconnection - Get blocks after SSE disconnection\n2. Polling - Check progress while streaming\n3. Final state - Get complete content after turn_complete\n\nReturns array of TurnBlock objects:\n- sequence (0-indexed order)\n- block_type (text, thinking, tool_use, etc.)\n- text_content (for text/thinking)\n- content (JSONB for block-specific data)",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698794230000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && Array.isArray(response)) {\n  console.log(`âœ… Retrieved ${response.length} blocks`);\n  response.forEach((block, i) => {\n    console.log(`Block ${i}: ${block.block_type} (sequence ${block.sequence})`);\n    if (block.text_content) {\n      const preview = block.text_content.substring(0, 50);\n      console.log(`  Text: \"${preview}${block.text_content.length > 50 ? '...' : ''}\"`);\n    }\n  });\n} else {\n  console.log('â„¹ï¸  No blocks yet or turn not found');\n}"
    },
    {
      "_id": "req_streaming_interrupt",
      "parentId": "fld_streaming",
      "modified": 1736467200000,
      "created": 1736467200000,
      "url": "{{ _.base_url }}/api/turns/{{ _.assistant_turn_id }}/interrupt",
      "name": "4. Interrupt Turn",
      "description": "Cancel an in-progress streaming turn\n\nBEHAVIOR:\n- Cancels the TurnExecutor\n- Updates turn status to 'cancelled'\n- Closes SSE streams for all connected clients\n- Partial blocks are saved to database\n\nONLY WORKS:\n- While turn is actively streaming (status='streaming')\n- Returns 404 if turn not found in executor registry\n\nRESPONSE:\n{\n  \"success\": true,\n  \"turn_id\": \"...\",\n  \"status\": \"cancelled\"\n}",
      "method": "POST",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698794220000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.success) {\n  console.log('âœ… Turn interrupted successfully');\n  console.log('Turn ID:', response.turn_id);\n  console.log('Status:', response.status);\n  console.log('');\n  console.log('ðŸ’¡ TIP: Check SSE stream - should close immediately');\n  console.log('ðŸ’¡ TIP: Call \"Get Turn Blocks\" to see partial content');\n} else {\n  console.log('âŒ Failed to interrupt turn');\n  console.log('Possible reasons:');\n  console.log('  â€¢ Turn is not currently streaming');\n  console.log('  â€¢ Turn already completed');\n  console.log('  â€¢ Invalid turn ID');\n}"
    },
    {
      "_id": "req_streaming_complete_sse",
      "parentId": "fld_streaming",
      "modified": 1736467200000,
      "created": 1736467200000,
      "url": "{{ _.base_url }}/api/turns/{{ _.turn_id }}/stream",
      "name": "5. Stream Already Complete Turn",
      "description": "Test reconnection to a turn that already finished streaming\n\nEXPECTED BEHAVIOR:\n- If turn status = 'complete': Immediate turn_complete event\n- If turn status = 'error': Immediate turn_error event\n- If turn status = 'streaming': Normal streaming flow\n\nUSE turn_id (not assistant_turn_id) to test with older completed turns",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698794210000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "console.log('ðŸ“¡ Connected to SSE stream');\nconsole.log('â„¹ï¸  For completed turns, expect immediate turn_complete event');\nconsole.log('â„¹ï¸  For in-progress turns, will receive live deltas');"
    },
    {
      "_id": "req_streaming_get_blocks_empty",
      "parentId": "fld_streaming",
      "modified": 1736467200000,
      "created": 1736467200000,
      "url": "{{ _.base_url }}/api/turns/{{ _.user_turn_id }}/blocks",
      "name": "6. Get Blocks (User Turn)",
      "description": "Test fetching blocks from a user turn\n\nEXPECTED:\n- Returns blocks for user turn (the input message)\n- Should have text_content with user's message\n\nCompare with assistant turn blocks to see streaming results",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698794200000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && Array.isArray(response)) {\n  console.log(`âœ… User turn has ${response.length} blocks`);\n  response.forEach((block, i) => {\n    console.log(`Block ${i}: ${block.block_type}`);\n    if (block.text_content) {\n      console.log(`  \"${block.text_content}\"`);\n    }\n  });\n}"
    },
    {
      "_id": "req_streaming_get_blocks_assistant",
      "parentId": "fld_streaming",
      "modified": 1736467200000,
      "created": 1736467200000,
      "url": "{{ _.base_url }}/api/turns/{{ _.assistant_turn_id }}/blocks",
      "name": "7. Get Blocks (Assistant Turn)",
      "description": "Test fetching blocks from a assistant turn\n\nEXPECTED:\n- Returns blocks for assistant turn (the output message)\n- Should have text_content with assistant's message\n\nCompare with user turn blocks to see streaming results",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698794200000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && Array.isArray(response)) {\n  console.log(`âœ… Assistant turn has ${response.length} blocks`);\n  response.forEach((block, i) => {\n    console.log(`Block ${i}: ${block.block_type}`);\n    if (block.text_content) {\n      console.log(`  \"${block.text_content}\"`);\n    }\n  });\n}"
    },
    {
      "_id": "req_workflow_full",
      "parentId": "fld_integration",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats",
      "name": "Workflow: Create Chat â†’ Turn â†’ Get Path",
      "description": "Full workflow demonstrating typical usage:\n1. Create chat\n2. Add user turn\n3. Get conversation path\n\nRun sequentially to test complete flow",
      "method": "POST",
      "body": {
        "mimeType": "application/json",
        "text": "{\n  \"project_id\": \"{{ _.project_id }}\",\n  \"title\": \"Workflow Test - Plot Analysis\"\n}"
      },
      "parameters": [],
      "headers": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ],
      "authentication": {},
      "metaSortKey": -1698795400000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.id) {\n  await insomnia.environment.set('workflow_chat_id', response.id);\n  console.log('âœ… Step 1/3: Created chat:', response.id);\n  console.log('ðŸ“ Next: Create a turn in this chat');\n  console.log('   POST /api/chats/' + response.id + '/turns');\n}"
    },
    {
      "_id": "req_test_seeded",
      "parentId": "fld_integration",
      "modified": 1698796800000,
      "created": 1698796800000,
      "url": "{{ _.base_url }}/api/chats/11111111-1111-1111-1111-111111111111",
      "name": "Test with Seeded Data",
      "description": "Get the seeded chat created by `make seed`\nID: 11111111-1111-1111-1111-111111111111\nContains 8 turns demonstrating branching conversation tree",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698795300000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.id) {\n  await insomnia.environment.set('seeded_chat_id', response.id);\n  console.log('âœ… Retrieved seeded chat');\n  console.log('Title:', response.title);\n  console.log('ðŸ’¡ This chat has a branching conversation tree');\n  console.log('   Try: GET /api/turns/{{turn_id}}/siblings to see versions');\n}"
    },
    {
      "_id": "fld_basic_ops",
      "parentId": "wrk_chat",
      "modified": 1698796800000,
      "created": 1698796800000,
      "name": "Basic Operations",
      "description": "Chat CRUD operations (Create, Read, Update, Delete)",
      "environment": {},
      "environmentPropertyOrder": null,
      "metaSortKey": -1698796800000,
      "_type": "request_group"
    },
    {
      "_id": "fld_turns",
      "parentId": "wrk_chat",
      "modified": 1698796800000,
      "created": 1698796800000,
      "name": "Turns",
      "description": "Turn creation and tree navigation",
      "environment": {},
      "environmentPropertyOrder": null,
      "metaSortKey": -1698796000000,
      "_type": "request_group"
    },
    {
      "_id": "fld_turn_blocks",
      "parentId": "wrk_chat",
      "modified": 1698796800000,
      "created": 1698796800000,
      "name": "Turn Blocks",
      "description": "Different turn block types (text, reference, partial)",
      "environment": {},
      "environmentPropertyOrder": null,
      "metaSortKey": -1698795000000,
      "_type": "request_group"
    },
    {
      "_id": "fld_streaming",
      "parentId": "wrk_chat",
      "modified": 1736467200000,
      "created": 1736467200000,
      "name": "Streaming",
      "description": "Real-time streaming tests - SSE events, reconnection, interruption",
      "environment": {},
      "environmentPropertyOrder": null,
      "metaSortKey": -1698794250000,
      "_type": "request_group"
    },
    {
      "_id": "fld_integration",
      "parentId": "wrk_chat",
      "modified": 1698796800000,
      "created": 1698796800000,
      "name": "Integration Tests",
      "description": "Multi-step workflows and seeded data tests",
      "environment": {},
      "environmentPropertyOrder": null,
      "metaSortKey": -1698794000000,
      "_type": "request_group"
    },
    {
      "_id": "req_chat_tree",
      "parentId": "fld_pagination",
      "modified": 1736553600000,
      "created": 1736553600000,
      "url": "{{ _.base_url }}/debug/api/chats/{{ _.chat_id }}/tree",
      "name": "1. Get Chat Tree (DEBUG ONLY)",
      "description": "âš ï¸ DEBUG ONLY - DO NOT USE IN PRODUCTION (only available in dev mode)\nRetrieve lightweight tree structure in depth-first order\nReturns only turn IDs and parent relationships (no content)\nProduction should use pagination endpoint which includes sibling_ids\n\nNote: This endpoint is ONLY registered when ENVIRONMENT=dev",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698792000000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.turns) {\n  console.log('âœ… Tree loaded');\n  console.log('Total turns:', response.turns.length);\n  console.log('Updated at:', response.updated_at);\n  if (response.turns.length > 0) {\n    console.log('Sample turn:', response.turns[0]);\n  }\n}"
    },
    {
      "_id": "req_paginated_turns_before",
      "parentId": "fld_pagination",
      "modified": 1736553600000,
      "created": 1736553600000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}/turns?limit=50&direction=before",
      "name": "2. Paginate Before (History)",
      "description": "Load conversation history (follow prev_turn_id backwards)\nUse for: Scrolling up, loading older messages\nReturns: Turns with nested blocks and sibling_ids",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698791900000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.turns) {\n  console.log('âœ… Pagination response:');\n  console.log('Turns loaded:', response.turns.length);\n  console.log('Has more before:', response.has_more_before);\n  console.log('Has more after:', response.has_more_after);\n  // Count total blocks (now nested in turns)\n  const totalBlocks = response.turns.reduce((sum, t) => sum + (t.blocks?.length || 0), 0);\n  console.log('Total blocks:', totalBlocks);\n  // Check for siblings\n  const turnsWithSiblings = response.turns.filter(t => t.sibling_ids?.length > 0).length;\n  console.log('Turns with siblings:', turnsWithSiblings);\n  if (response.turns.length > 0 && response.turns[0].sibling_ids) {\n    console.log('Sample sibling_ids:', response.turns[0].sibling_ids);\n  }\n}"
    },
    {
      "_id": "req_paginated_turns_after",
      "parentId": "fld_pagination",
      "modified": 1736553600000,
      "created": 1736553600000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}/turns?from_turn_id={{ _.user_turn_id }}&limit=50&direction=after",
      "name": "3. Paginate After (Future)",
      "description": "Load subsequent messages (follow most recent child forward)\nUse for: Scrolling down, loading newer messages\nFollows most recent child when multiple siblings exist\nReturns: Turns with nested blocks and sibling_ids",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698791800000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.turns) {\n  console.log('âœ… Pagination response:');\n  console.log('Turns loaded:', response.turns.length);\n  console.log('Has more before:', response.has_more_before);\n  console.log('Has more after:', response.has_more_after);\n  // Count total blocks (now nested in turns)\n  const totalBlocks = response.turns.reduce((sum, t) => sum + (t.blocks?.length || 0), 0);\n  console.log('Total blocks:', totalBlocks);\n  // Check for siblings\n  const turnsWithSiblings = response.turns.filter(t => t.sibling_ids?.length > 0).length;\n  console.log('Turns with siblings:', turnsWithSiblings);\n}"
    },
    {
      "_id": "req_paginated_turns_both",
      "parentId": "fld_pagination",
      "modified": 1736553600000,
      "created": 1736553600000,
      "url": "{{ _.base_url }}/api/chats/{{ _.chat_id }}/turns?from_turn_id={{ _.user_turn_id }}&limit=100&direction=both",
      "name": "4. Paginate Both (Context Window)",
      "description": "Load context around a specific turn (25% before, 75% after)\nUse for: Initial load, jumping to a specific message\nDefaults to last_viewed_turn_id if from_turn_id not specified\nReturns: Turns with nested blocks and sibling_ids",
      "method": "GET",
      "body": {},
      "parameters": [],
      "headers": [],
      "authentication": {},
      "metaSortKey": -1698791700000,
      "isPrivate": false,
      "_type": "request",
      "afterResponseScript": "const response = insomnia.response.json();\nif (response && response.turns) {\n  console.log('âœ… Pagination response:');\n  console.log('Turns loaded:', response.turns.length);\n  console.log('Has more before:', response.has_more_before);\n  console.log('Has more after:', response.has_more_after);\n  const totalBlocks = response.turns.reduce((sum, t) => sum + (t.blocks?.length || 0), 0);\n  console.log('Total blocks:', totalBlocks);\n  // Count turns before/after from_turn_id\n  const fromId = '{{ _.user_turn_id }}';\n  const fromIndex = response.turns.findIndex(t => t.id === fromId);\n  if (fromIndex >= 0) {\n    console.log('Turns before from_turn_id:', fromIndex);\n    console.log('Turns after from_turn_id:', response.turns.length - fromIndex - 1);\n  }\n}"
    },
    {
      "_id": "fld_pagination",
      "parentId": "wrk_chat",
      "modified": 1736553600000,
      "created": 1736553600000,
      "name": "Pagination",
      "description": "Paginated turn loading for large conversations (1000+ turns)\nReturns turns with nested blocks and sibling_ids for branch discovery\nPrimary endpoint for production - tree endpoint is debug-only",
      "environment": {},
      "environmentPropertyOrder": null,
      "metaSortKey": -1698792500000,
      "_type": "request_group"
    },
    {
      "_id": "wrk_chat",
      "parentId": null,
      "modified": 1698796800000,
      "created": 1698796800000,
      "name": "04 - Chat",
      "description": "Chat API - Conversation management with tree structure, content blocks, and streaming",
      "scope": "collection",
      "_type": "workspace"
    },
    {
      "_id": "env_base",
      "parentId": "wrk_chat",
      "modified": 1736467200000,
      "created": 1698796800000,
      "name": "Base Environment",
      "data": {
        "base_url": "http://localhost:8080",
        "project_id": "00000000-0000-0000-0000-000000000001",
        "document_id": "",
        "root_document_id": "",
        "chat_id": "",
        "turn_id": "",
        "root_turn_id": "",
        "user_turn_id": "",
        "assistant_turn_id": "",
        "branch_turn_id": "",
        "workflow_chat_id": "",
        "streaming_turn_id": "",
        "seeded_chat_id": "11111111-1111-1111-1111-111111111111",
        "llm_model": "lorem-fast",
        "llm_max_tokens": 200,
        "llm_model_streaming": "lorem-slow",
        "llm_max_tokens_streaming": 500
      },
      "dataPropertyOrder": {
        "&": [
          "base_url",
          "project_id",
          "document_id",
          "root_document_id",
          "chat_id",
          "turn_id",
          "root_turn_id",
          "user_turn_id",
          "assistant_turn_id",
          "branch_turn_id",
          "workflow_chat_id",
          "streaming_turn_id",
          "seeded_chat_id",
          "llm_model",
          "llm_max_tokens",
          "llm_model_streaming",
          "llm_max_tokens_streaming"
        ]
      },
      "color": null,
      "isPrivate": false,
      "metaSortKey": 1698796800000,
      "_type": "environment"
    }
  ]
}
