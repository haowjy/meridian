# Server Configuration
PORT=8080
ENVIRONMENT=dev

# === PHASE 1: Only This is Needed ===
# Choose ONE connection type based on your environment:

# Option 1: Pooled Connection (Port 6543) - RECOMMENDED for Development
# - Works from any IP (no whitelisting needed)
# - Uses PgBouncer (Supabase's connection pooler)
# - Port 6543 is AUTO-DETECTED and configures simple protocol (no prepared statements)
# - You can also explicitly set: ?default_query_exec_mode=simple_protocol
# Get from: Supabase Dashboard → Settings → Database → Connection String → Transaction mode
SUPABASE_DB_URL=postgresql://postgres.[PROJECT]:[YOUR-PASSWORD]@aws-0-us-east-1.pooler.supabase.com:6543/postgres

# Option 2: Direct Connection (Port 5432) - RECOMMENDED for Production
# - Requires IP whitelisting in Supabase dashboard
# - Best performance, uses prepared statements automatically
# - Use this when deploying to Railway/Vercel/etc with static IP
# Get from: Supabase Dashboard → Settings → Database → Connection String → Direct connection
# SUPABASE_DB_URL=postgresql://postgres:[YOUR-PASSWORD]@db.your-project.supabase.co:5432/postgres

# === REQUIRED: Supabase Auth ===
# Get from: Supabase Dashboard → Settings → API

# Project URL (REQUIRED for JWT verification)
# The JWKS URL is auto-constructed from this: {SUPABASE_URL}/auth/v1/.well-known/jwks.json
SUPABASE_URL=https://your-project.supabase.co

# Use the NEW "secret key" format (sb_secret_...), NOT legacy JWT
# For backend/server use - keep this secret!
SUPABASE_KEY=sb_secret_your-key-here

# Note: Don't use the legacy "service_role" JWT format (eyJhbGc...)
# The new secret keys are easier to rotate and more secure

# CORS - Frontend URLs
CORS_ORIGINS=http://localhost:3000

# LLM Configuration
# Get your API key from: https://console.anthropic.com/settings/keys
ANTHROPIC_API_KEY=your-anthropic-api-key-here

OPENROUTER_API_KEY=sk-your-openrouter-key-here

# Default model for LLM responses
# Example: moonshotai/kimi-k2-thinking (OpenRouter Kimi thinking model)
DEFAULT_MODEL=moonshotai/kimi-k2-thinking

# Default max number of tool call round trips before stopping an assistant turn
MAX_TOOL_ROUNDS=10

# Web Search API Configuration (optional - enables web_search tool)
# Get free API key from: https://tavily.com (1,000 queries/month free tier)
# Leave blank to disable web search tool
SEARCH_API_KEY=tvly-your-api-key-here
SEARCH_API_PROVIDER=tavily

# Frontend Usage:
# Send {"name": "tavily_web_search"} in tools array
# Backend maps to "web_search" tool that Claude calls
# Backend executes via Tavily API

# Alternative providers (coming soon):
# - brave_web_search: Brave Search API (2K free queries/month)
# - serper_web_search: Serper.dev ($1 per 1K queries)
# - exa_web_search: Exa AI (neural search, ~$15 per 1K queries)


# Debug mode (enables SSE event IDs for testing)
DEBUG=false

LOG_TO_FILE=true
LOG_DIR=./logs        # optional, default: ./logs
LOG_MAX_FILES=10      # optional, default: 10